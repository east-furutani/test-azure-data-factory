{
	"name": "csv_db_bulk_budget_temp_table",
	"properties": {
		"folder": {
			"name": "予算データ"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "test_blob_storage_nsw",
						"type": "LinkedServiceReference"
					},
					"name": "csvFileRead"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "temp_budget",
						"type": "DatasetReference"
					},
					"name": "csvDataInMiddleTable"
				}
			],
			"transformations": [
				{
					"name": "toDecimal"
				}
			],
			"scriptLines": [
				"parameters{",
				"     latestDatetimeFileName as string ('budget_20251105053200.csv')",
				"}",
				"source(output(",
				"          {販売伝票} as string,",
				"          {販売伝票タイプ} as string,",
				"          {整理年月} as string,",
				"          {営業所} as string,",
				"          {営業所名称} as string,",
				"          {営業グループ} as string,",
				"          {営業グループ名称} as string,",
				"          {需要家} as string,",
				"          {商品群コード} as string,",
				"          {商品群名} as string,",
				"          {品目コード} as string,",
				"          {品目テキスト} as string,",
				"          {売上（基本）数量} as string,",
				"          {売上（請求金額）} as string,",
				"          {限界利益} as string,",
				"          {売上総利益} as string,",
				"          {伝票通貨} as string,",
				"          {出荷名コード} as string,",
				"          {出荷名} as string,",
				"          {販売単価} as string,",
				"          {請求数量（在庫単位）} as string,",
				"          {運賃} as string,",
				"          {購入単価} as string,",
				"          {販売直接費} as string,",
				"          {請求単価} as string,",
				"          {変動製造費} as string,",
				"          {出荷数量} as string,",
				"          {請求数量} as string,",
				"          {購入金額} as string,",
				"          {実績原価} as string,",
				"          {販売数量} as string,",
				"          {販売価格} as string,",
				"          {輸送費} as string,",
				"          {固定製造費} as string,",
				"          {登録日-DISPLAY_KEY} as string,",
				"          {請求日-DISPLAY_KEY} as string,",
				"          {販売伝票明細-DISPLAY_KEY} as string,",
				"          {販売伝票タイプ名称-DISPLAY_KEY} as string,",
				"          {受注先コード-DISPLAY_KEY} as string,",
				"          {受注先略称-DISPLAY_KEY} as string,",
				"          {出荷先コード-DISPLAY_KEY} as string,",
				"          {出荷先略称-DISPLAY_KEY} as string,",
				"          {カスタマコード-DISPLAY_KEY} as string,",
				"          {カスタマ略称-DISPLAY_KEY} as string,",
				"          {請求先コード-DISPLAY_KEY} as string,",
				"          {請求先略称-DISPLAY_KEY} as string,",
				"          {支払人コード-DISPLAY_KEY} as string,",
				"          {支払人略称-DISPLAY_KEY} as string,",
				"          {営業員コード-DISPLAY_KEY} as string,",
				"          {営業員名称-DISPLAY_KEY} as string,",
				"          {運送業者コード-DISPLAY_KEY} as string,",
				"          {運送業者略称-DISPLAY_KEY} as string,",
				"          {OEMコード-DISPLAY_KEY} as string,",
				"          {OEM名称1-DISPLAY_KEY} as string,",
				"          {仕入先コード-DISPLAY_KEY} as string,",
				"          {仕入先略称-DISPLAY_KEY} as string,",
				"          {荷姿名-DISPLAY_KEY} as string,",
				"          {商標コード-DISPLAY_KEY} as string,",
				"          {商標名-DISPLAY_KEY} as string,",
				"          {商品大分類コード-DISPLAY_KEY} as string,",
				"          {商品大分類名-DISPLAY_KEY} as string,",
				"          {製品群コード-DISPLAY_KEY} as string,",
				"          {製品群名-DISPLAY_KEY} as string,",
				"          {プラント-DISPLAY_KEY} as string,",
				"          {プラント名称-DISPLAY_KEY} as string,",
				"          {出荷ポイント-DISPLAY_KEY} as string,",
				"          {出荷ポイント名称-DISPLAY_KEY} as string,",
				"          {指定納期-DISPLAY_KEY} as date 'yyyy/MM/dd',",
				"          {納入日付-DISPLAY_KEY} as date 'yyyy/MM/dd',",
				"          {出荷予定日-DISPLAY_KEY} as date 'yyyy/MM/dd',",
				"          {出荷転記日-DISPLAY_KEY} as date 'yyyy/MM/dd',",
				"          {購買発注伝票-DISPLAY_KEY} as string,",
				"          {請求伝票-DISPLAY_KEY} as string,",
				"          {登録者-DISPLAY_KEY} as string,",
				"          {販売組織-DISPLAY_KEY} as string,",
				"          {販売組織名称-DISPLAY_KEY} as string,",
				"          {流通チャネル-DISPLAY_KEY} as string,",
				"          {流通チャネル名称-DISPLAY_KEY} as string,",
				"          {製品部門-DISPLAY_KEY} as string,",
				"          {製品部門名称-DISPLAY_KEY} as string,",
				"          {購入通貨-DISPLAY_KEY} as string,",
				"          {販売単位-DISPLAY_KEY} as string,",
				"          {基本単位-DISPLAY_KEY} as string,",
				"          {条件単位-DISPLAY_KEY} as string,",
				"          {出荷数量単位-DISPLAY_KEY} as string,",
				"          {請求数量単位-DISPLAY_KEY} as string,",
				"          {在庫単位-DISPLAY_KEY} as string,",
				"          {販売直接費（運賃以外）-DISPLAY_KEY} as string,",
				"          {登録時刻-DISPLAY_KEY} as timestamp 'yyyy/MM/dd HH:mm:ss'",
				"     ),",
				"     useSchema: false,",
				"     allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: true,",
				"     format: 'delimited',",
				"     container: 'sales-forecast-data',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\"',",
				"     quoteChar: '\\\"',",
				"     encodingName: 'SHIFT-JIS',",
				"     columnNamesAsHeader: true,",
				"     wildcardPaths:[($latestDatetimeFileName)]) ~> csvFileRead",
				"csvFileRead derive({売上（基本）数量} = toDecimal({売上（基本）数量}, 12, 2),",
				"          {売上（請求金額）} = toDecimal({売上（請求金額）}, 15, 2),",
				"          {限界利益} = toDecimal({限界利益}, 15, 2),",
				"          {売上総利益} = toDecimal({売上総利益}, 15, 2),",
				"          {販売単価} = toDecimal({販売単価}, 15, 2),",
				"          {請求数量（在庫単位）} = toDecimal({請求数量（在庫単位）}, 12, 2),",
				"          {運賃} = toDecimal({運賃}, 15, 2),",
				"          {購入単価} = toDecimal({購入単価}, 15, 2),",
				"          {販売直接費} = toDecimal({販売直接費}, 15, 2),",
				"          {請求単価} = toDecimal({請求単価}, 15, 2),",
				"          {変動製造費} = toDecimal({変動製造費}, 15, 2),",
				"          {出荷数量} = toDecimal(({出荷数量}), 12, 2),",
				"          {請求数量} = toDecimal({請求数量}, 12, 2),",
				"          {購入金額} = toDecimal({購入金額}, 15, 2),",
				"          {実績原価} = toDecimal({実績原価}, 15, 2),",
				"          {販売数量} = toDecimal({販売数量}, 12, 2),",
				"          {販売価格} = toDecimal({販売価格}, 15, 2),",
				"          {輸送費} = toDecimal({輸送費}, 15, 2),",
				"          {固定製造費} = toDecimal({固定製造費}, 15, 2),",
				"          {販売直接費（運賃以外）-DISPLAY_KEY} = toDecimal({販売直接費（運賃以外）-DISPLAY_KEY}, 15, 2)) ~> toDecimal",
				"toDecimal sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          sales_id as string,",
				"          voucher_type as string,",
				"          processing_date as string,",
				"          sales_office as string,",
				"          sales_office_name as string,",
				"          sales_group as string,",
				"          sales_group_name as string,",
				"          sales_consumer as string,",
				"          sales_item_group_cd as string,",
				"          sales_item_group_name as string,",
				"          item_id as string,",
				"          item_name as string,",
				"          sales_qty as decimal(12,2),",
				"          sales_amount as decimal(15,2),",
				"          marginal_profit as decimal(15,2),",
				"          gross_profit as decimal(15,2),",
				"          accounting_currency as string,",
				"          shipping_name_cd as string,",
				"          shipping_name as string,",
				"          sales_unit_price as decimal(15,2),",
				"          billing_qty_inventory_unit as decimal(12,2),",
				"          fare as decimal(15,2),",
				"          purchase_unit_price as decimal(15,2),",
				"          direct_selling_costs as decimal(15,2),",
				"          billing_price as decimal(15,2),",
				"          variable_costs as decimal(15,2),",
				"          shipment_qty as decimal(12,2),",
				"          billing_qty as decimal(12,2),",
				"          purchase_price as decimal(15,2),",
				"          actual_cost as decimal(15,2),",
				"          sales_volume as decimal(12,2),",
				"          sales_price as decimal(15,2),",
				"          transportation_cost as decimal(15,2),",
				"          fixed_costs as decimal(15,2),",
				"          created_date_time as string,",
				"          billing_date as string,",
				"          sales_document_details as string,",
				"          voucher_type_name as string,",
				"          customer_cd as string,",
				"          customer_short_name as string,",
				"          sales_ship_to_account_num as string,",
				"          sales_ship_to_short_name as string,",
				"          sales_end_user_account_num as string,",
				"          sales_end_user_short_name as string,",
				"          invoice_account as string,",
				"          sales_invoice_short_name as string,",
				"          payer_cd as string,",
				"          payer_short_name as string,",
				"          sales_person as string,",
				"          sales_person_name as string,",
				"          carrier_cd as string,",
				"          carrier_name_alias as string,",
				"          oem_cd as string,",
				"          oem_name as string,",
				"          sales_vend_account_num as string,",
				"          sales_vend_name_alias as string,",
				"          pack_style_name as string,",
				"          trade_mark_cd as string,",
				"          trade_mark_name as string,",
				"          sales_item_class_cd as string,",
				"          sales_item_class_name as string,",
				"          product_item_group_cd as string,",
				"          product_item_group_name as string,",
				"          invent_site_id as string,",
				"          invent_site_name as string,",
				"          shipping_point as string,",
				"          shipping_point_name as string,",
				"          specified_delivery_date as date,",
				"          delivery_date as date,",
				"          estimated_ship_date as date,",
				"          shipment_posting_date as date,",
				"          purchase_order_document as string,",
				"          billing_document as string,",
				"          registrant as string,",
				"          sales_organization as string,",
				"          sales_organization_name as string,",
				"          distribution_channels as string,",
				"          distribution_channels_name as string,",
				"          product_department as string,",
				"          product_department_name as string,",
				"          purchase_currency as string,",
				"          sales_unit as string,",
				"          base_unit as string,",
				"          condition_unit as string,",
				"          shipping_unit_of_measure as string,",
				"          billing_unit_of_measure as string,",
				"          inventory_unit as string,",
				"          direct_selling_costs_excl_fare as decimal(15,2),",
				"          registration_time as timestamp",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     saveOrder: 1,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          sales_id = {販売伝票},",
				"          voucher_type = {販売伝票タイプ},",
				"          processing_date = {整理年月},",
				"          sales_office = {営業所},",
				"          sales_office_name = {営業所名称},",
				"          sales_group = {営業グループ},",
				"          sales_group_name = {営業グループ名称},",
				"          sales_consumer = {需要家},",
				"          sales_item_group_cd = {商品群コード},",
				"          sales_item_group_name = {商品群名},",
				"          item_id = {品目コード},",
				"          item_name = {品目テキスト},",
				"          sales_qty = {売上（基本）数量},",
				"          sales_amount = {売上（請求金額）},",
				"          marginal_profit = {限界利益},",
				"          gross_profit = {売上総利益},",
				"          accounting_currency = {伝票通貨},",
				"          shipping_name_cd = {出荷名コード},",
				"          shipping_name = {出荷名},",
				"          sales_unit_price = {販売単価},",
				"          billing_qty_inventory_unit = {請求数量（在庫単位）},",
				"          fare = {運賃},",
				"          purchase_unit_price = {購入単価},",
				"          direct_selling_costs = {販売直接費},",
				"          billing_price = {請求単価},",
				"          variable_costs = {変動製造費},",
				"          shipment_qty = {出荷数量},",
				"          billing_qty = {請求数量},",
				"          purchase_price = {購入金額},",
				"          actual_cost = {実績原価},",
				"          sales_volume = {販売数量},",
				"          sales_price = {販売価格},",
				"          transportation_cost = {輸送費},",
				"          fixed_costs = {固定製造費},",
				"          created_date_time = {登録日-DISPLAY_KEY},",
				"          billing_date = {請求日-DISPLAY_KEY},",
				"          sales_document_details = {販売伝票明細-DISPLAY_KEY},",
				"          voucher_type_name = {販売伝票タイプ名称-DISPLAY_KEY},",
				"          customer_cd = {受注先コード-DISPLAY_KEY},",
				"          customer_short_name = {受注先略称-DISPLAY_KEY},",
				"          sales_ship_to_account_num = {出荷先コード-DISPLAY_KEY},",
				"          sales_ship_to_short_name = {出荷先略称-DISPLAY_KEY},",
				"          sales_end_user_account_num = {カスタマコード-DISPLAY_KEY},",
				"          sales_end_user_short_name = {カスタマ略称-DISPLAY_KEY},",
				"          invoice_account = {請求先コード-DISPLAY_KEY},",
				"          sales_invoice_short_name = {請求先略称-DISPLAY_KEY},",
				"          payer_cd = {支払人コード-DISPLAY_KEY},",
				"          payer_short_name = {支払人略称-DISPLAY_KEY},",
				"          sales_person = {営業員コード-DISPLAY_KEY},",
				"          sales_person_name = {営業員名称-DISPLAY_KEY},",
				"          carrier_cd = {運送業者コード-DISPLAY_KEY},",
				"          carrier_name_alias = {運送業者略称-DISPLAY_KEY},",
				"          oem_cd = {OEMコード-DISPLAY_KEY},",
				"          oem_name = {OEM名称1-DISPLAY_KEY},",
				"          sales_vend_account_num = {仕入先コード-DISPLAY_KEY},",
				"          sales_vend_name_alias = {仕入先略称-DISPLAY_KEY},",
				"          pack_style_name = {荷姿名-DISPLAY_KEY},",
				"          trade_mark_cd = {商標コード-DISPLAY_KEY},",
				"          trade_mark_name = {商標名-DISPLAY_KEY},",
				"          sales_item_class_cd = {商品大分類コード-DISPLAY_KEY},",
				"          sales_item_class_name = {商品大分類名-DISPLAY_KEY},",
				"          product_item_group_cd = {製品群コード-DISPLAY_KEY},",
				"          product_item_group_name = {製品群名-DISPLAY_KEY},",
				"          invent_site_id = {プラント-DISPLAY_KEY},",
				"          invent_site_name = {プラント名称-DISPLAY_KEY},",
				"          shipping_point = {出荷ポイント-DISPLAY_KEY},",
				"          shipping_point_name = {出荷ポイント名称-DISPLAY_KEY},",
				"          specified_delivery_date = {指定納期-DISPLAY_KEY},",
				"          delivery_date = {納入日付-DISPLAY_KEY},",
				"          estimated_ship_date = {出荷予定日-DISPLAY_KEY},",
				"          shipment_posting_date = {出荷転記日-DISPLAY_KEY},",
				"          purchase_order_document = {購買発注伝票-DISPLAY_KEY},",
				"          billing_document = {請求伝票-DISPLAY_KEY},",
				"          registrant = {登録者-DISPLAY_KEY},",
				"          sales_organization = {販売組織-DISPLAY_KEY},",
				"          sales_organization_name = {販売組織名称-DISPLAY_KEY},",
				"          distribution_channels = {流通チャネル-DISPLAY_KEY},",
				"          distribution_channels_name = {流通チャネル名称-DISPLAY_KEY},",
				"          product_department = {製品部門-DISPLAY_KEY},",
				"          product_department_name = {製品部門名称-DISPLAY_KEY},",
				"          purchase_currency = {購入通貨-DISPLAY_KEY},",
				"          sales_unit = {販売単位-DISPLAY_KEY},",
				"          base_unit = {基本単位-DISPLAY_KEY},",
				"          condition_unit = {条件単位-DISPLAY_KEY},",
				"          shipping_unit_of_measure = {出荷数量単位-DISPLAY_KEY},",
				"          billing_unit_of_measure = {請求数量単位-DISPLAY_KEY},",
				"          inventory_unit = {在庫単位-DISPLAY_KEY},",
				"          direct_selling_costs_excl_fare = {販売直接費（運賃以外）-DISPLAY_KEY},",
				"          registration_time = {登録時刻-DISPLAY_KEY}",
				"     )) ~> csvDataInMiddleTable"
			]
		}
	}
}