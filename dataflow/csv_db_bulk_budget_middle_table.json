{
	"name": "csv_db_bulk_budget_middle_table",
	"properties": {
		"folder": {
			"name": "予算データ"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "test_blob_storage_nsw",
						"type": "LinkedServiceReference"
					},
					"name": "csvFileRead"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "temp_budget",
						"type": "DatasetReference"
					},
					"name": "csvDataInMiddleTable",
					"rejectedDataLinkedService": {
						"referenceName": "test_blob_storage_nsw",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [],
			"scriptLines": [
				"parameters{",
				"     latestDateTime as string ('サンプル_2025予算Uploadデータ 経営コックピット_SAC.csv')",
				"}",
				"source(output(",
				"          {PK\u0003\u0004\u0014\u0000\u0006\u0000\b\u0000\u0000\u0000!\u0000�ﾉ7ｯ�\u0001\u0000\u0000�\u0006\u0000\u0000\u0013\u0000ﾗ\u0001[Content_Types].xml ｢ﾓ\u0001(�\u0000\u0002\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000ｼ筆Oﾂ@\u0010��&��fｯ�.`b牽p�罟$b穹�\u000etﾃ~eg@��n\u0017ｬ� �\u0010/ﾝｴ掣ﾟgｦ3ioｰ0:佞@虱ﾁ:y嫺`K'幅\u0014�e�ﾐｺf\u0019腸Rhg｡`K@6陝滸FK\u000f佛l�\u0005ｫ蔭} as string",
				"     ),",
				"     useSchema: false,",
				"     allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: true,",
				"     format: 'delimited',",
				"     container: 'test-nsw',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     encodingName: 'SHIFT-JIS',",
				"     columnNamesAsHeader: true,",
				"     wildcardPaths:[(concat('予算データ/', $latestDateTime))]) ~> csvFileRead",
				"csvFileRead sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          sales_id as string,",
				"          voucher_type as string,",
				"          processing_date as string,",
				"          sales_office as string,",
				"          sales_office_name as string,",
				"          sales_group as string,",
				"          sales_group_name as string,",
				"          sales_consumer as string,",
				"          sales_item_group_cd as string,",
				"          sales_item_group_name as string,",
				"          item_id as string,",
				"          item_name as string,",
				"          sales_qty as decimal(12,2),",
				"          sales_amount as decimal(15,2),",
				"          marginal_profit as decimal(15,2),",
				"          gross_profit as decimal(15,2),",
				"          accounting_currency as string,",
				"          shipping_name_cd as string,",
				"          shipping_name as string,",
				"          sales_unit_price as decimal(15,2),",
				"          billing_qty_inventory_unit as decimal(12,2),",
				"          fare as decimal(15,2),",
				"          purchase_unit_price as decimal(15,2),",
				"          direct_selling_costs as decimal(15,2),",
				"          billing_price as decimal(15,2),",
				"          variable_costs as decimal(15,2),",
				"          shipment_qty as decimal(12,2),",
				"          billing_qty as decimal(12,2),",
				"          purchase_price as decimal(15,2),",
				"          actual_cost as decimal(15,2),",
				"          sales_volume as decimal(12,2),",
				"          sales_price as decimal(15,2),",
				"          transportation_cost as decimal(15,2),",
				"          fixed_costs as decimal(15,2),",
				"          created_date_time as string,",
				"          billing_date as string,",
				"          sales_document_details as string,",
				"          voucher_type_name as string,",
				"          customer_cd as string,",
				"          customer_short_name as string,",
				"          sales_ship_to_account_num as string,",
				"          sales_ship_to_short_name as string,",
				"          sales_end_user_account_num as string,",
				"          sales_end_user_short_name as string,",
				"          invoice_account as string,",
				"          sales_invoice_short_name as string,",
				"          payer_cd as string,",
				"          payer_short_name as string,",
				"          sales_person as string,",
				"          sales_person_name as string,",
				"          carrier_cd as string,",
				"          carrier_name_alias as string,",
				"          oem_cd as string,",
				"          oem_name as string,",
				"          sales_vend_account_num as string,",
				"          sales_vend_name_alias as string,",
				"          pack_style_name as string,",
				"          trade_mark_cd as string,",
				"          trade_mark_name as string,",
				"          sales_item_class_cd as string,",
				"          sales_item_class_name as string,",
				"          product_item_group_cd as string,",
				"          product_item_group_name as string,",
				"          invent_site_id as string,",
				"          invent_site_name as string,",
				"          shipping_point as string,",
				"          shipping_point_name as string,",
				"          specified_delivery_date as date,",
				"          delivery_date as date,",
				"          estimated_ship_date as date,",
				"          shipment_posting_date as date,",
				"          purchase_order_document as string,",
				"          billing_document as string,",
				"          registrant as string,",
				"          sales_organization as string,",
				"          sales_organization_name as string,",
				"          distribution_channels as string,",
				"          distribution_channels_name as string,",
				"          product_department as string,",
				"          product_department_name as string,",
				"          purchase_currency as string,",
				"          sales_unit as string,",
				"          base_unit as string,",
				"          condition_unit as string,",
				"          shipping_unit_of_measure as string,",
				"          billing_unit_of_measure as string,",
				"          inventory_unit as string,",
				"          direct_selling_costs_excl_fare as decimal(15,2),",
				"          registration_time as timestamp",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     saveOrder: 1,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          sales_id = {処理年月},",
				"          voucher_type = {販売注文},",
				"          line_num = {明細行番号},",
				"          voucher_type = {伝票タイプ},",
				"          cust_account = {顧客},",
				"          cust_short_name = {略称},",
				"          sales_ship_to_account_num = {出荷先コード},",
				"          sales_ship_to_short_name = {出荷先-略称},",
				"          cust_collections = {回収先ID},",
				"          sales_cust_collection_short_name = {回収先-略称},",
				"          sales_vend_account_num = {仕入先},",
				"          sales_vend_name_alias = {仕入先-検索名},",
				"          sales_office = {営業所},",
				"          sales_office_name = {営業所名},",
				"          sales_group = {営業所グループ},",
				"          sales_group_name = {営業所グループ名},",
				"          sales_end_user_account_num = {カスタマー},",
				"          sales_end_user_short_name = {カスタマー略称},",
				"          invoice_account = {請求先/元 ID},",
				"          sales_invoice_short_name = {請求先-略称},",
				"          sales_invoice_name = {請求先-名前},",
				"          sales_person = {営業員},",
				"          sales_person_name = {営業員名},",
				"          sales_consumer = {需要家},",
				"          carrier_cd = {運送業者},",
				"          carrier_name_alias = {運送業者-検索名},",
				"          item_id = {品目番号},",
				"          item_name = {テキスト},",
				"          pack_style_name = {荷姿名},",
				"          shipping_name_code = {出荷名コード},",
				"          shipping_name = {出荷名名称},",
				"          trade_mark_code = {商標コード},",
				"          trade_mark_name = {商標名},",
				"          sales_item_class_code = {商品大分類コード},",
				"          sales_item_class_name = {商品大分類名},",
				"          product_item_group_code = {製品群コード},",
				"          product_item_group_name = {製品群名},",
				"          sales_item_group_code = {商品群コード},",
				"          sales_item_group_name = {商品群名},",
				"          invent_site_id = {サイト},",
				"          invent_site_name = {サイト名},",
				"          invent_location_id = {倉庫},",
				"          invent_location_name = {倉庫名},",
				"          contract_unit_qty = {契約単位数量},",
				"          contract_unit_price_uom = {契約単価単位},",
				"          sales_qty = {販売-数量},",
				"          sales_unit = {販売-単位},",
				"          sales_amount = {販売-金額},",
				"          invoice_contract_unit_qty = {請求書-契約単位数量},",
				"          invoice_contract_unit_price_uom = {請求書-契約単価単位},",
				"          invoice_amount = {請求書-金額},",
				"          invoice_additional_costs = {請求書-台貫金額(諸費用)},",
				"          backlog_amount = {受注残金額},",
				"          accounting_currency = {会計通貨},",
				"          invoice_date = {請求書-計上日},",
				"          processing_date = {整理年月},",
				"          created_by = {作成者},",
				"          created_date_time = {作成日時},",
				"          shipping_date_requested = {出荷予定日},",
				"          receipt_date_requested = {入荷希望日}",
				"     )) ~> csvDataInMiddleTable"
			]
		}
	}
}