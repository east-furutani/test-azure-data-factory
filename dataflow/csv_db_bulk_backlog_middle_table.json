{
	"name": "csv_db_bulk_backlog_middle_table",
	"properties": {
		"folder": {
			"name": "受注残"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "test_blob_storage_nsw",
						"type": "LinkedServiceReference"
					},
					"name": "csvFileRead"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AzureSqlBacklogMiddleTable",
						"type": "DatasetReference"
					},
					"name": "csvDataInMiddleTable",
					"rejectedDataLinkedService": {
						"referenceName": "test_blob_storage_nsw",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [],
			"scriptLines": [
				"parameters{",
				"     latestDateTime as string ('backlog_202510_202512_20251105053200.csv')",
				"}",
				"source(output(",
				"          {処理年月} as string,",
				"          {販売注文} as string,",
				"          {明細行番号} as integer,",
				"          {伝票タイプ} as string,",
				"          {顧客} as string,",
				"          {略称} as string,",
				"          {出荷先コード} as string,",
				"          {出荷先-略称} as string,",
				"          {回収先ID} as string,",
				"          {回収先-略称} as string,",
				"          {仕入先} as string,",
				"          {仕入先-検索名} as string,",
				"          {営業所} as short,",
				"          {営業所名} as string,",
				"          {営業所グループ} as short,",
				"          {営業所グループ名} as string,",
				"          {カスタマー} as string,",
				"          {カスタマー略称} as string,",
				"          {請求先/元 ID} as string,",
				"          {請求先-略称} as string,",
				"          {請求先-名前} as string,",
				"          {営業員} as string,",
				"          {営業員名} as string,",
				"          {需要家} as string,",
				"          {運送業者} as string,",
				"          {運送業者-検索名} as string,",
				"          {品目番号} as string,",
				"          {テキスト} as string,",
				"          {荷姿名} as string,",
				"          {出荷名コード} as string,",
				"          {出荷名名称} as string,",
				"          {商標コード} as short,",
				"          {商標名} as string,",
				"          {商品大分類コード} as short,",
				"          {商品大分類名} as string,",
				"          {製品群コード} as string,",
				"          {製品群名} as string,",
				"          {商品群コード} as string,",
				"          {商品群名} as string,",
				"          {サイト} as short,",
				"          {サイト名} as string,",
				"          {倉庫} as string,",
				"          {倉庫名} as string,",
				"          {契約単位数量} as short,",
				"          {契約単価単位} as string,",
				"          {販売-数量} as short,",
				"          {販売-単位} as string,",
				"          {販売-金額} as integer,",
				"          {請求書-契約単位数量} as integer,",
				"          {請求書-契約単価単位} as string,",
				"          {請求書-金額} as integer,",
				"          {請求書-台貫金額(諸費用)} as integer,",
				"          {受注残金額} as integer,",
				"          {会計通貨} as string,",
				"          {請求書-計上日} as date 'yyyy/MM/dd',",
				"          {整理年月} as string,",
				"          {作成者} as string,",
				"          {作成日時} as timestamp 'yyyy/MM/dd HH:mm:ss',",
				"          {出荷予定日} as date 'yyyy/MM/dd',",
				"          {入荷希望日} as date 'yyyy/MM/dd'",
				"     ),",
				"     useSchema: false,",
				"     allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: true,",
				"     format: 'delimited',",
				"     container: 'test-nsw',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     encodingName: 'SHIFT-JIS',",
				"     columnNamesAsHeader: true,",
				"     wildcardPaths:[(concat('受注残/', $latestDateTime))]) ~> csvFileRead",
				"csvFileRead sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          system_date as string,",
				"          sales_id as string,",
				"          line_num as integer,",
				"          voucher_type as string,",
				"          cust_account as string,",
				"          cust_short_name as string,",
				"          sales_ship_to_account_num as string,",
				"          sales_ship_to_short_name as string,",
				"          cust_collections as string,",
				"          sales_cust_collection_short_name as string,",
				"          sales_vend_account_num as string,",
				"          sales_vend_name_alias as string,",
				"          sales_office as string,",
				"          sales_office_name as string,",
				"          sales_group as string,",
				"          sales_group_name as string,",
				"          sales_end_user_account_num as string,",
				"          sales_end_user_short_name as string,",
				"          invoice_account as string,",
				"          sales_invoice_short_name as string,",
				"          sales_invoice_name as string,",
				"          sales_person as string,",
				"          sales_person_name as string,",
				"          sales_consumer as string,",
				"          carrier_cd as string,",
				"          carrier_name_alias as string,",
				"          item_id as string,",
				"          item_name as string,",
				"          pack_style_name as string,",
				"          shipping_name_code as string,",
				"          shipping_name as string,",
				"          trade_mark_code as string,",
				"          trade_mark_name as string,",
				"          sales_item_class_code as string,",
				"          sales_item_class_name as string,",
				"          product_item_group_code as string,",
				"          product_item_group_name as string,",
				"          sales_item_group_code as string,",
				"          sales_item_group_name as string,",
				"          invent_site_id as string,",
				"          invent_site_name as string,",
				"          invent_location_id as string,",
				"          invent_location_name as string,",
				"          contract_unit_qty as decimal(12,2),",
				"          contract_unit_price_uom as string,",
				"          sales_qty as decimal(12,2),",
				"          sales_unit as string,",
				"          sales_amount as decimal(15,2),",
				"          invoice_contract_unit_qty as decimal(12,2),",
				"          invoice_contract_unit_price_uom as string,",
				"          invoice_amount as decimal(15,2),",
				"          invoice_additional_costs as decimal(15,2),",
				"          backlog_amount as decimal(15,2),",
				"          accounting_currency as string,",
				"          invoice_date as date,",
				"          processing_date as string,",
				"          created_by as string,",
				"          created_date_time as timestamp,",
				"          shipping_date_requested as date,",
				"          receipt_date_requested as date",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     saveOrder: 1,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          system_date = {処理年月},",
				"          sales_id = {販売注文},",
				"          line_num = {明細行番号},",
				"          voucher_type = {伝票タイプ},",
				"          cust_account = {顧客},",
				"          cust_short_name = {略称},",
				"          sales_ship_to_account_num = {出荷先コード},",
				"          sales_ship_to_short_name = {出荷先-略称},",
				"          cust_collections = {回収先ID},",
				"          sales_cust_collection_short_name = {回収先-略称},",
				"          sales_vend_account_num = {仕入先},",
				"          sales_vend_name_alias = {仕入先-検索名},",
				"          sales_office = {営業所},",
				"          sales_office_name = {営業所名},",
				"          sales_group = {営業所グループ},",
				"          sales_group_name = {営業所グループ名},",
				"          sales_end_user_account_num = {カスタマー},",
				"          sales_end_user_short_name = {カスタマー略称},",
				"          invoice_account = {請求先/元 ID},",
				"          sales_invoice_short_name = {請求先-略称},",
				"          sales_invoice_name = {請求先-名前},",
				"          sales_person = {営業員},",
				"          sales_person_name = {営業員名},",
				"          sales_consumer = {需要家},",
				"          carrier_cd = {運送業者},",
				"          carrier_name_alias = {運送業者-検索名},",
				"          item_id = {品目番号},",
				"          item_name = {テキスト},",
				"          pack_style_name = {荷姿名},",
				"          shipping_name_code = {出荷名コード},",
				"          shipping_name = {出荷名名称},",
				"          trade_mark_code = {商標コード},",
				"          trade_mark_name = {商標名},",
				"          sales_item_class_code = {商品大分類コード},",
				"          sales_item_class_name = {商品大分類名},",
				"          product_item_group_code = {製品群コード},",
				"          product_item_group_name = {製品群名},",
				"          sales_item_group_code = {商品群コード},",
				"          sales_item_group_name = {商品群名},",
				"          invent_site_id = {サイト},",
				"          invent_site_name = {サイト名},",
				"          invent_location_id = {倉庫},",
				"          invent_location_name = {倉庫名},",
				"          contract_unit_qty = {契約単位数量},",
				"          contract_unit_price_uom = {契約単価単位},",
				"          sales_qty = {販売-数量},",
				"          sales_unit = {販売-単位},",
				"          sales_amount = {販売-金額},",
				"          invoice_contract_unit_qty = {請求書-契約単位数量},",
				"          invoice_contract_unit_price_uom = {請求書-契約単価単位},",
				"          invoice_amount = {請求書-金額},",
				"          invoice_additional_costs = {請求書-台貫金額(諸費用)},",
				"          backlog_amount = {受注残金額},",
				"          accounting_currency = {会計通貨},",
				"          invoice_date = {請求書-計上日},",
				"          processing_date = {整理年月},",
				"          created_by = {作成者},",
				"          created_date_time = {作成日時},",
				"          shipping_date_requested = {出荷予定日},",
				"          receipt_date_requested = {入荷希望日}",
				"     )) ~> csvDataInMiddleTable"
			]
		}
	}
}