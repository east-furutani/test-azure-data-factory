{
	"name": "csv_db_bulk_plstatement_temp_table",
	"properties": {
		"folder": {
			"name": "実績損益"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "test_blob_storage_nsw",
						"type": "LinkedServiceReference"
					},
					"name": "csvFileRead"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "temp_plstatement",
						"type": "DatasetReference"
					},
					"name": "csvDataInMiddleTable"
				}
			],
			"transformations": [
				{
					"name": "toDecimal"
				}
			],
			"scriptLines": [
				"parameters{",
				"     latestDatetimeFileName as string ('plstatement_20251105053200.csv')",
				"}",
				"source(output(",
				"          Column1 as date 'yyyy/MM/dd',",
				"          Column2 as string,",
				"          Column3 as integer,",
				"          Column4 as string,",
				"          Column5 as string,",
				"          Column6 as string,",
				"          Column7 as string,",
				"          Column8 as string,",
				"          Column9 as string,",
				"          Column10 as string,",
				"          Column11 as string,",
				"          Column12 as string,",
				"          Column13 as string,",
				"          Column14 as string,",
				"          Column15 as string,",
				"          Column16 as string,",
				"          Column17 as string,",
				"          Column18 as string,",
				"          Column19 as string,",
				"          Column20 as string,",
				"          Column21 as string,",
				"          Column22 as string,",
				"          Column23 as string,",
				"          Column24 as string,",
				"          Column25 as string,",
				"          Column26 as string,",
				"          Column27 as string,",
				"          Column28 as string,",
				"          Column29 as string,",
				"          Column30 as string,",
				"          Column31 as string,",
				"          Column32 as string,",
				"          Column33 as string,",
				"          Column34 as string,",
				"          Column35 as string,",
				"          Column36 as string,",
				"          Column37 as string,",
				"          Column38 as string,",
				"          Column39 as string,",
				"          Column40 as string,",
				"          Column41 as string,",
				"          Column42 as string,",
				"          Column43 as string,",
				"          Column44 as string,",
				"          Column45 as string,",
				"          Column46 as string,",
				"          Column47 as string,",
				"          Column48 as string,",
				"          Column49 as string,",
				"          Column50 as string,",
				"          Column51 as string,",
				"          Column52 as string,",
				"          Column53 as string,",
				"          Column54 as string,",
				"          Column55 as string,",
				"          Column56 as string,",
				"          Column57 as string,",
				"          Column58 as string,",
				"          Column59 as string,",
				"          Column60 as string,",
				"          Column61 as string,",
				"          Column62 as string,",
				"          Column63 as string,",
				"          Column64 as string,",
				"          Column65 as string,",
				"          Column66 as string,",
				"          Column67 as string,",
				"          Column68 as string,",
				"          Column69 as string,",
				"          Column70 as string,",
				"          Column71 as string,",
				"          Column72 as string,",
				"          Column73 as string,",
				"          Column74 as string,",
				"          Column75 as string,",
				"          Column76 as string,",
				"          Column77 as string,",
				"          Column78 as string,",
				"          Column79 as string,",
				"          Column80 as string,",
				"          Column81 as string,",
				"          Column82 as string,",
				"          Column83 as string,",
				"          Column84 as string,",
				"          Column85 as string,",
				"          Column86 as string,",
				"          Column87 as string,",
				"          Column88 as date 'yyyy/MM/dd',",
				"          Column89 as date 'yyyy/MM/dd',",
				"          Column90 as date 'yyyy/MM/dd',",
				"          Column91 as string,",
				"          Column92 as string,",
				"          Column93 as string,",
				"          Column94 as string,",
				"          Column95 as string,",
				"          Column96 as string,",
				"          Column97 as string,",
				"          Column98 as string,",
				"          Column99 as string,",
				"          Column100 as string,",
				"          Column101 as string,",
				"          Column102 as string,",
				"          Column103 as string,",
				"          Column104 as string,",
				"          Column105 as integer,",
				"          Column106 as date 'yyyy/MM/dd',",
				"          Column107 as string,",
				"          Column108 as string,",
				"          Column109 as integer,",
				"          Column110 as timestamp 'yyyy/MM/dd HH:mm:ss',",
				"          Column111 as string,",
				"          Column112 as string,",
				"          Column113 as string,",
				"          Column114 as string,",
				"          Column115 as string,",
				"          Column116 as string,",
				"          Column117 as timestamp 'yyyy/MM/dd HH:mm:ss',",
				"          Column118 as string,",
				"          Column119 as string,",
				"          Column120 as string,",
				"          Column121 as string,",
				"          Column122 as string,",
				"          Column123 as string,",
				"          Column124 as string,",
				"          Column125 as string,",
				"          Column126 as string,",
				"          Column127 as string,",
				"          Column128 as string,",
				"          Column129 as string,",
				"          Column130 as string,",
				"          Column131 as string,",
				"          Column132 as string,",
				"          Column133 as string,",
				"          Column134 as string,",
				"          Column135 as string,",
				"          Column136 as string,",
				"          Column137 as string,",
				"          Column138 as string,",
				"          Column139 as string,",
				"          Column140 as string,",
				"          Column141 as string,",
				"          Column142 as string",
				"     ),",
				"     useSchema: false,",
				"     allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: true,",
				"     format: 'delimited',",
				"     container: 'sales-forecast-data',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\"',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true,",
				"     wildcardPaths:[(concat('output/', $latestDatetimeFileName))]) ~> csvFileRead",
				"csvFileRead derive(Column120 = toDecimal(Column120, 12, 2),",
				"          Column121 = toDecimal(Column121, 12, 2),",
				"          Column123 = toDecimal(Column123, 12, 2),",
				"          Column125 = toDecimal(Column125, 15, 2),",
				"          Column126 = toDecimal(Column126, 15, 2),",
				"          Column127 = toDecimal(Column127, 12, 2),",
				"          Column128 = toDecimal(Column128, 12, 2),",
				"          Column129 = toDecimal(Column129, 12, 2),",
				"          Column130 = toDecimal(Column130, 15, 2),",
				"          Column131 = toDecimal(Column131, 15, 2),",
				"          Column132 = toDecimal(Column132, 15, 2),",
				"          Column133 = toDecimal(Column133, 5, 2),",
				"          Column134 = toDecimal(Column134, 15, 2),",
				"          Column135 = toDecimal(Column135, 15, 2),",
				"          Column136 = toDecimal(Column136, 15, 2),",
				"          Column137 = toDecimal(Column137, 15, 2),",
				"          Column138 = toDecimal(Column138, 15, 2)) ~> toDecimal",
				"toDecimal sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          system_date as date,",
				"          sales_id as string,",
				"          line_num as integer,",
				"          corporate_code as string,",
				"          source_id as string,",
				"          voucher_type as string,",
				"          sales_office as string,",
				"          sales_office_name as string,",
				"          sales_group as string,",
				"          sales_group_name as string,",
				"          cust_account as string,",
				"          cust_short_name as string,",
				"          phone_number as string,",
				"          sales_ship_to_account_num as string,",
				"          sales_ship_to_short_name as string,",
				"          sales_ship_to_name as string,",
				"          sales_ship_to_name2 as string,",
				"          sales_ship_to_belonging as string,",
				"          sales_ship_to_name_notes as string,",
				"          sales_ship_to_prefectures as string,",
				"          sales_ship_to_municipality as string,",
				"          sales_ship_to_address as string,",
				"          sales_ship_to_building_name as string,",
				"          sales_ship_to_address_notes as string,",
				"          sales_ship_to_remarks1 as string,",
				"          sales_ship_to_remarks2 as string,",
				"          sales_ship_to_remarks3 as string,",
				"          sales_ship_to_phone_num as string,",
				"          sales_end_user_account_num as string,",
				"          sales_end_user_short_name as string,",
				"          invoice_account as string,",
				"          sales_invoice_short_name as string,",
				"          sales_invoice_name as string,",
				"          sales_invoice_name2 as string,",
				"          sales_invoice_belonging as string,",
				"          sales_invoice_name_notes as string,",
				"          sales_invoice_post_code as string,",
				"          sales_invoice_prefectures as string,",
				"          sales_invoice_municipality as string,",
				"          sales_invoice_address as string,",
				"          sales_invoice_building_name as string,",
				"          sales_invoice_address_notes as string,",
				"          sales_invoice_remarks1 as string,",
				"          sales_invoice_remarks2 as string,",
				"          sales_invoice_remarks3 as string,",
				"          cust_collections as string,",
				"          sales_cust_collection_short_name as string,",
				"          sales_person as string,",
				"          sales_person_name as string,",
				"          carrier_cd as string,",
				"          carrier_name_alias as string,",
				"          oem_cd as string,",
				"          oem_name as string,",
				"          oem_name2 as string,",
				"          oem_prefectures as string,",
				"          oem_municipality as string,",
				"          oem_address as string,",
				"          oem_building_name as string,",
				"          oem_address_notes as string,",
				"          oem_remarks1 as string,",
				"          oem_remarks2 as string,",
				"          oem_remarks3 as string,",
				"          sales_vend_account_num as string,",
				"          sales_vend_name_alias as string,",
				"          customer_requirements as string,",
				"          billing_block as string,",
				"          item_id as string,",
				"          item_name as string,",
				"          pack_style_name as string,",
				"          shipping_name_code as string,",
				"          shipping_name as string,",
				"          trade_mark_code as string,",
				"          trade_mark_name as string,",
				"          sales_item_class_code as string,",
				"          sales_item_class_name as string,",
				"          product_item_group_code as string,",
				"          product_item_group_name as string,",
				"          sales_item_group_code as string,",
				"          sales_item_group_name as string,",
				"          shipping_type as string,",
				"          truck_scale_type as string,",
				"          product_type as string,",
				"          correction_category as string,",
				"          invent_site_id as string,",
				"          invent_site_name as string,",
				"          invent_location_id as string,",
				"          invent_location_name as string,",
				"          receipt_date_requested as date,",
				"          shipping_date_requested as date,",
				"          shipping_date as date,",
				"          sales_status as string,",
				"          delivery_method as string,",
				"          delivery_method_description as string,",
				"          detailed_status as string,",
				"          customer_delete_flag as string,",
				"          customer_delete_reason as string,",
				"          purchase_order_number as string,",
				"          purchase_order_status as string,",
				"          picking_route as string,",
				"          inventory_order as string,",
				"          picking_status as string,",
				"          line_status as string,",
				"          truck_scale_completion_flag as string,",
				"          invoice as string,",
				"          invoice_line_num as integer,",
				"          invoice_date as date,",
				"          delivery_note_category as string,",
				"          delivery_note_category_name as string,",
				"          closing_date as integer,",
				"          created_date_time as timestamp,",
				"          created_by as string,",
				"          shipping_terms as string,",
				"          shipping_terms_description as string,",
				"          payment_terms as string,",
				"          payment_terms_description as string,",
				"          sales_consumer as string,",
				"          updated_date_time as timestamp,",
				"          updated_by as string,",
				"          profit_and_loss_department as string,",
				"          qty_per_pack as decimal(12,2),",
				"          sales_qty as decimal(12,2),",
				"          sales_unit as string,",
				"          contract_unit_qty as decimal(12,2),",
				"          contract_unit_price_uom as string,",
				"          contract_unit_price as decimal(15,2),",
				"          net_amount as decimal(15,2),",
				"          shipping_qty as decimal(12,2),",
				"          invoice_qty as decimal(12,2),",
				"          invoice_unit_qty as decimal(12,2),",
				"          invoice_contract_unit_price as decimal(15,2),",
				"          invoice_net_amount as decimal(15,2),",
				"          consumption_tax as decimal(15,2),",
				"          tax_rate as decimal(5,2),",
				"          factory_variable_costs as decimal(15,2),",
				"          factory_fixed_costs as decimal(15,2),",
				"          direct_delivery_variable_costs as decimal(15,2),",
				"          one_price_variable_costs as decimal(15,2),",
				"          one_price_fixed_costs as decimal(15,2),",
				"          accounting_currency as string,",
				"          countryregionid as string,",
				"          country as string,",
				"          billinig_date as string",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     saveOrder: 1,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          system_date = Column1,",
				"          sales_id = Column2,",
				"          line_num = Column3,",
				"          corporate_code = Column4,",
				"          source_id = Column5,",
				"          voucher_type = Column6,",
				"          sales_office = Column7,",
				"          sales_office_name = Column8,",
				"          sales_group = Column9,",
				"          sales_group_name = Column10,",
				"          cust_account = Column11,",
				"          cust_short_name = Column12,",
				"          phone_number = Column13,",
				"          sales_ship_to_account_num = Column14,",
				"          sales_ship_to_short_name = Column15,",
				"          sales_ship_to_name = Column16,",
				"          sales_ship_to_name2 = Column17,",
				"          sales_ship_to_belonging = Column18,",
				"          sales_ship_to_name_notes = Column19,",
				"          sales_ship_to_prefectures = Column20,",
				"          sales_ship_to_municipality = Column21,",
				"          sales_ship_to_address = Column22,",
				"          sales_ship_to_building_name = Column23,",
				"          sales_ship_to_address_notes = Column24,",
				"          sales_ship_to_remarks1 = Column25,",
				"          sales_ship_to_remarks2 = Column26,",
				"          sales_ship_to_remarks3 = Column27,",
				"          sales_ship_to_phone_num = Column28,",
				"          sales_end_user_account_num = Column29,",
				"          sales_end_user_short_name = Column30,",
				"          invoice_account = Column31,",
				"          sales_invoice_short_name = Column32,",
				"          sales_invoice_name = Column33,",
				"          sales_invoice_name2 = Column34,",
				"          sales_invoice_belonging = Column35,",
				"          sales_invoice_name_notes = Column36,",
				"          sales_invoice_post_code = Column37,",
				"          sales_invoice_prefectures = Column38,",
				"          sales_invoice_municipality = Column39,",
				"          sales_invoice_address = Column40,",
				"          sales_invoice_building_name = Column41,",
				"          sales_invoice_address_notes = Column42,",
				"          sales_invoice_remarks1 = Column43,",
				"          sales_invoice_remarks2 = Column44,",
				"          sales_invoice_remarks3 = Column45,",
				"          cust_collections = Column46,",
				"          sales_cust_collection_short_name = Column47,",
				"          sales_person = Column48,",
				"          sales_person_name = Column49,",
				"          carrier_cd = Column50,",
				"          carrier_name_alias = Column51,",
				"          oem_cd = Column52,",
				"          oem_name = Column53,",
				"          oem_name2 = Column54,",
				"          oem_prefectures = Column55,",
				"          oem_municipality = Column56,",
				"          oem_address = Column57,",
				"          oem_building_name = Column58,",
				"          oem_address_notes = Column59,",
				"          oem_remarks1 = Column60,",
				"          oem_remarks2 = Column61,",
				"          oem_remarks3 = Column62,",
				"          sales_vend_account_num = Column63,",
				"          sales_vend_name_alias = Column64,",
				"          customer_requirements = Column65,",
				"          billing_block = Column66,",
				"          item_id = Column67,",
				"          item_name = Column68,",
				"          pack_style_name = Column69,",
				"          shipping_name_code = Column70,",
				"          shipping_name = Column71,",
				"          trade_mark_code = Column72,",
				"          trade_mark_name = Column73,",
				"          sales_item_class_code = Column74,",
				"          sales_item_class_name = Column75,",
				"          product_item_group_code = Column76,",
				"          product_item_group_name = Column77,",
				"          sales_item_group_code = Column78,",
				"          sales_item_group_name = Column79,",
				"          shipping_type = Column80,",
				"          truck_scale_type = Column81,",
				"          product_type = Column82,",
				"          correction_category = Column83,",
				"          invent_site_id = Column84,",
				"          invent_site_name = Column85,",
				"          invent_location_id = Column86,",
				"          invent_location_name = Column87,",
				"          receipt_date_requested = Column88,",
				"          shipping_date_requested = Column89,",
				"          shipping_date = Column90,",
				"          sales_status = Column91,",
				"          delivery_method = Column92,",
				"          delivery_method_description = Column93,",
				"          detailed_status = Column94,",
				"          customer_delete_flag = Column95,",
				"          customer_delete_reason = Column96,",
				"          purchase_order_number = Column97,",
				"          purchase_order_status = Column98,",
				"          picking_route = Column99,",
				"          inventory_order = Column100,",
				"          picking_status = Column101,",
				"          line_status = Column102,",
				"          truck_scale_completion_flag = Column103,",
				"          invoice = Column104,",
				"          invoice_line_num = Column105,",
				"          invoice_date = Column106,",
				"          delivery_note_category = Column107,",
				"          delivery_note_category_name = Column108,",
				"          closing_date = Column109,",
				"          created_date_time = Column110,",
				"          created_by = Column111,",
				"          shipping_terms = Column112,",
				"          shipping_terms_description = Column113,",
				"          payment_terms = Column114,",
				"          payment_terms_description = Column115,",
				"          sales_consumer = Column116,",
				"          updated_date_time = Column117,",
				"          updated_by = Column118,",
				"          profit_and_loss_department = Column119,",
				"          qty_per_pack = Column120,",
				"          sales_qty = Column121,",
				"          sales_unit = Column122,",
				"          contract_unit_qty = Column123,",
				"          contract_unit_price_uom = Column124,",
				"          contract_unit_price = Column125,",
				"          net_amount = Column126,",
				"          shipping_qty = Column127,",
				"          invoice_qty = Column128,",
				"          invoice_unit_qty = Column129,",
				"          invoice_contract_unit_price = Column130,",
				"          invoice_net_amount = Column131,",
				"          consumption_tax = Column132,",
				"          tax_rate = Column133,",
				"          factory_variable_costs = Column134,",
				"          factory_fixed_costs = Column135,",
				"          direct_delivery_variable_costs = Column136,",
				"          one_price_variable_costs = Column137,",
				"          one_price_fixed_costs = Column138,",
				"          accounting_currency = Column139,",
				"          countryregionid = Column140,",
				"          country = Column141,",
				"          billinig_date = Column142",
				"     )) ~> csvDataInMiddleTable"
			]
		}
	}
}