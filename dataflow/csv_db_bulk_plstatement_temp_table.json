{
	"name": "csv_db_bulk_plstatement_temp_table",
	"properties": {
		"folder": {
			"name": "実績損益"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "test_blob_storage_nsw",
						"type": "LinkedServiceReference"
					},
					"name": "csvFileRead"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "temp_plstatement",
						"type": "DatasetReference"
					},
					"name": "csvDataInMiddleTable"
				}
			],
			"transformations": [
				{
					"name": "toDecimal"
				}
			],
			"scriptLines": [
				"parameters{",
				"     latestDatetimeFileName as string ('plstatement_20251105053200.csv')",
				"}",
				"source(output(",
				"          {日付} as date 'yyyy/MM/dd',",
				"          {販売注文} as string,",
				"          {明細行番号} as integer,",
				"          {法人コード} as string,",
				"          {コピー元ID} as string,",
				"          {伝票タイプ} as string,",
				"          {営業所} as string,",
				"          {営業所名} as string,",
				"          {営業グループ} as string,",
				"          {営業グループ名} as string,",
				"          {顧客} as string,",
				"          {略称} as string,",
				"          {電話番号} as string,",
				"          {出荷先} as string,",
				"          {出荷先-略称} as string,",
				"          {出荷先-名前} as string,",
				"          {出荷先-名前2} as string,",
				"          {出荷先-所属} as string,",
				"          {出荷先-名前備考} as string,",
				"          {出荷先-都道府県} as string,",
				"          {出荷先-市町村} as string,",
				"          {出荷先-住所} as string,",
				"          {出荷先-建物名} as string,",
				"          {出荷先-住所備考} as string,",
				"          {出荷先-備考1} as string,",
				"          {出荷先-備考2} as string,",
				"          {出荷先-備考3} as string,",
				"          {出荷先-電話番号} as string,",
				"          {カスタマー} as string,",
				"          {カスタマー-略称} as string,",
				"          {請求先/元ID} as string,",
				"          {請求先-略称} as string,",
				"          {請求先-名前} as string,",
				"          {請求先-名前2} as string,",
				"          {請求先-所属} as string,",
				"          {請求先-名前備考} as string,",
				"          {請求先-郵便番号} as string,",
				"          {請求先-都道府県} as string,",
				"          {請求先-市町村} as string,",
				"          {請求先-住所} as string,",
				"          {請求先-建物名} as string,",
				"          {請求先-住所備考} as string,",
				"          {請求先-備考1} as string,",
				"          {請求先-備考2} as string,",
				"          {請求先-備考3} as string,",
				"          {回収先ID} as string,",
				"          {回収先-略称} as string,",
				"          {営業員} as string,",
				"          {営業員名} as string,",
				"          {運送業者} as string,",
				"          {運送業者-検索名} as string,",
				"          {OEMコード} as string,",
				"          {OEM-名前} as string,",
				"          {OEM-名前2} as string,",
				"          {OEM-都道府県} as string,",
				"          {OEM-市町村} as string,",
				"          {OEM-住所} as string,",
				"          {OEM-建物名} as string,",
				"          {OEM-住所備考} as string,",
				"          {OEM-備考1} as string,",
				"          {OEM-備考2} as string,",
				"          {OEM-備考3} as string,",
				"          {仕入先} as string,",
				"          {仕入先-検索名} as string,",
				"          {顧客の要求} as string,",
				"          {請求ブロック} as string,",
				"          {品目番号} as string,",
				"          {テキスト} as string,",
				"          {荷姿} as string,",
				"          {出荷名コード} as string,",
				"          {出荷名} as string,",
				"          {商標コード} as string,",
				"          {商標名} as string,",
				"          {商品大分類コード} as string,",
				"          {商品大分類名} as string,",
				"          {製品群コード} as string,",
				"          {製品群名} as string,",
				"          {商品群コード} as string,",
				"          {商品群名} as string,",
				"          {配送タイプ} as string,",
				"          {台貫区分} as string,",
				"          {製品タイプ} as string,",
				"          {訂正区分} as string,",
				"          {サイト} as string,",
				"          {サイト名} as string,",
				"          {倉庫} as string,",
				"          {倉庫名} as string,",
				"          {入荷希望日} as date 'yyyy/MM/dd',",
				"          {出荷予定日} as date 'yyyy/MM/dd',",
				"          {出荷日} as date 'yyyy/MM/dd',",
				"          {処理ステータス} as string,",
				"          {荷渡方法} as string,",
				"          {荷渡方法-説明} as string,",
				"          {詳細ステータス} as string,",
				"          {カスタマー台帳削除} as string,",
				"          {カスタマー台帳削除理由} as string,",
				"          {発注書番号} as string,",
				"          {発注書-行ステータス} as string,",
				"          {ピッキング ルート} as string,",
				"          {在庫注文} as string,",
				"          {処理ステータス2} as string,",
				"          {販売注文-行ステータス} as string,",
				"          {台貫完了区分} as string,",
				"          {請求書} as string,",
				"          {明細行番号2} as integer,",
				"          {請求日} as date 'yyyy/MM/dd',",
				"          {納品書区分} as string,",
				"          {納品書区分名} as string,",
				"          {締日} as integer,",
				"          {作成日時} as timestamp 'yyyy/MM/dd HH:mm',",
				"          {作成者} as string,",
				"          {配送条件} as string,",
				"          {配送条件-説明} as string,",
				"          {支払条件} as string,",
				"          {支払条件-説明} as string,",
				"          {需要家} as string,",
				"          {変更日時} as timestamp 'yyyy/MM/dd HH:mm',",
				"          {更新者} as string,",
				"          {損益負担部門} as string,",
				"          {入数} as string,",
				"          {数量} as string,",
				"          {販売単位} as string,",
				"          {契約単価数量} as string,",
				"          {契約単価単位} as string,",
				"          {契約単価} as string,",
				"          {正味金額} as string,",
				"          {出荷数量} as string,",
				"          {請求時数量} as string,",
				"          {請求時契約単価数量} as string,",
				"          {請求時契約単価} as string,",
				"          {請求時正味金額} as string,",
				"          {消費税額} as string,",
				"          {税率} as string,",
				"          {変動製造費（工場）} as string,",
				"          {固定製造費（工場）} as string,",
				"          {変動製造費（直納）} as string,",
				"          {変動製造費（一物一価）} as string,",
				"          {固定製造費（一物一価）} as string,",
				"          {会計通貨} as string,",
				"          {国／地域コード} as string,",
				"          {国名} as string,",
				"          {請求年月} as string",
				"     ),",
				"     useSchema: false,",
				"     allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: true,",
				"     format: 'delimited',",
				"     container: 'sales-forecast-data',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\"',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true,",
				"     wildcardPaths:[(concat('output/', $latestDatetimeFileName))]) ~> csvFileRead",
				"csvFileRead derive({入数} = toDecimal({入数}, 12, 2),",
				"          {数量} = toDecimal({数量}, 12, 2),",
				"          {契約単価数量} = toDecimal({契約単価数量}, 12, 2),",
				"          {契約単価} = toDecimal({契約単価}, 15, 2),",
				"          {正味金額} = toDecimal({正味金額}, 15, 2),",
				"          {出荷数量} = toDecimal({出荷数量}, 12, 2),",
				"          {請求時数量} = toDecimal({請求時数量}, 12, 2),",
				"          {請求時契約単価数量} = toDecimal({請求時契約単価数量}, 12, 2),",
				"          {請求時契約単価} = toDecimal({請求時契約単価}, 15, 2),",
				"          {請求時正味金額} = toDecimal({請求時正味金額}, 15, 2),",
				"          {消費税額} = toDecimal({消費税額}, 15, 2),",
				"          {税率} = toDecimal({税率}, 5, 2),",
				"          {変動製造費（工場）} = toDecimal({変動製造費（工場）}, 15, 2),",
				"          {固定製造費（工場）} = toDecimal({固定製造費（工場）}, 15, 2),",
				"          {変動製造費（直納）} = toDecimal({変動製造費（直納）}, 15, 2),",
				"          {変動製造費（一物一価）} = toDecimal({変動製造費（一物一価）}, 15, 2),",
				"          {固定製造費（一物一価）} = toDecimal({固定製造費（一物一価）}, 15, 2)) ~> toDecimal",
				"toDecimal sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          system_date as date,",
				"          sales_id as string,",
				"          line_num as integer,",
				"          corporate_code as string,",
				"          source_id as string,",
				"          voucher_type as string,",
				"          sales_office as string,",
				"          sales_office_name as string,",
				"          sales_group as string,",
				"          sales_group_name as string,",
				"          cust_account as string,",
				"          cust_short_name as string,",
				"          phone_number as string,",
				"          sales_ship_to_account_num as string,",
				"          sales_ship_to_short_name as string,",
				"          sales_ship_to_name as string,",
				"          sales_ship_to_name2 as string,",
				"          sales_ship_to_belonging as string,",
				"          sales_ship_to_name_notes as string,",
				"          sales_ship_to_prefectures as string,",
				"          sales_ship_to_municipality as string,",
				"          sales_ship_to_address as string,",
				"          sales_ship_to_building_name as string,",
				"          sales_ship_to_address_notes as string,",
				"          sales_ship_to_remarks1 as string,",
				"          sales_ship_to_remarks2 as string,",
				"          sales_ship_to_remarks3 as string,",
				"          sales_ship_to_phone_num as string,",
				"          sales_end_user_account_num as string,",
				"          sales_end_user_short_name as string,",
				"          invoice_account as string,",
				"          sales_invoice_short_name as string,",
				"          sales_invoice_name as string,",
				"          sales_invoice_name2 as string,",
				"          sales_invoice_belonging as string,",
				"          sales_invoice_name_notes as string,",
				"          sales_invoice_post_code as string,",
				"          sales_invoice_prefectures as string,",
				"          sales_invoice_municipality as string,",
				"          sales_invoice_address as string,",
				"          sales_invoice_building_name as string,",
				"          sales_invoice_address_notes as string,",
				"          sales_invoice_remarks1 as string,",
				"          sales_invoice_remarks2 as string,",
				"          sales_invoice_remarks3 as string,",
				"          cust_collections as string,",
				"          sales_cust_collection_short_name as string,",
				"          sales_person as string,",
				"          sales_person_name as string,",
				"          carrier_cd as string,",
				"          carrier_name_alias as string,",
				"          oem_cd as string,",
				"          oem_name as string,",
				"          oem_name2 as string,",
				"          oem_prefectures as string,",
				"          oem_municipality as string,",
				"          oem_address as string,",
				"          oem_building_name as string,",
				"          oem_address_notes as string,",
				"          oem_remarks1 as string,",
				"          oem_remarks2 as string,",
				"          oem_remarks3 as string,",
				"          sales_vend_account_num as string,",
				"          sales_vend_name_alias as string,",
				"          customer_requirements as string,",
				"          billing_block as string,",
				"          item_id as string,",
				"          item_name as string,",
				"          pack_style_name as string,",
				"          shipping_name_code as string,",
				"          shipping_name as string,",
				"          trade_mark_code as string,",
				"          trade_mark_name as string,",
				"          sales_item_class_code as string,",
				"          sales_item_class_name as string,",
				"          product_item_group_code as string,",
				"          product_item_group_name as string,",
				"          sales_item_group_code as string,",
				"          sales_item_group_name as string,",
				"          shipping_type as string,",
				"          truck_scale_type as string,",
				"          product_type as string,",
				"          correction_category as string,",
				"          invent_site_id as string,",
				"          invent_site_name as string,",
				"          invent_location_id as string,",
				"          invent_location_name as string,",
				"          receipt_date_requested as date,",
				"          shipping_date_requested as date,",
				"          shipping_date as date,",
				"          sales_status as string,",
				"          delivery_method as string,",
				"          delivery_method_description as string,",
				"          detailed_status as string,",
				"          customer_delete_flag as string,",
				"          customer_delete_reason as string,",
				"          purchase_order_number as string,",
				"          purchase_order_status as string,",
				"          picking_route as string,",
				"          inventory_order as string,",
				"          picking_status as string,",
				"          line_status as string,",
				"          truck_scale_completion_flag as string,",
				"          invoice as string,",
				"          invoice_line_num as integer,",
				"          invoice_date as date,",
				"          delivery_note_category as string,",
				"          delivery_note_category_name as string,",
				"          closing_date as integer,",
				"          created_date_time as timestamp,",
				"          created_by as string,",
				"          shipping_terms as string,",
				"          shipping_terms_description as string,",
				"          payment_terms as string,",
				"          payment_terms_description as string,",
				"          sales_consumer as string,",
				"          updated_date_time as timestamp,",
				"          updated_by as string,",
				"          profit_and_loss_department as string,",
				"          qty_per_pack as decimal(12,2),",
				"          sales_qty as decimal(12,2),",
				"          sales_unit as string,",
				"          contract_unit_qty as decimal(12,2),",
				"          contract_unit_price_uom as string,",
				"          contract_unit_price as decimal(15,2),",
				"          net_amount as decimal(15,2),",
				"          shipping_qty as decimal(12,2),",
				"          invoice_qty as decimal(12,2),",
				"          invoice_unit_qty as decimal(12,2),",
				"          invoice_contract_unit_price as decimal(15,2),",
				"          invoice_net_amount as decimal(15,2),",
				"          consumption_tax as decimal(15,2),",
				"          tax_rate as decimal(5,2),",
				"          factory_variable_costs as decimal(15,2),",
				"          factory_fixed_costs as decimal(15,2),",
				"          direct_delivery_variable_costs as decimal(15,2),",
				"          one_price_variable_costs as decimal(15,2),",
				"          one_price_fixed_costs as decimal(15,2),",
				"          accounting_currency as string,",
				"          countryregionid as string,",
				"          country as string,",
				"          billinig_date as string",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     saveOrder: 1,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          system_date = {日付},",
				"          sales_id = {販売注文},",
				"          line_num = {明細行番号},",
				"          corporate_code = {法人コード},",
				"          source_id = {コピー元ID},",
				"          voucher_type = {伝票タイプ},",
				"          sales_office = {営業所},",
				"          sales_office_name = {営業所名},",
				"          sales_group = {営業グループ},",
				"          sales_group_name = {営業グループ名},",
				"          cust_account = {顧客},",
				"          cust_short_name = {略称},",
				"          phone_number = {電話番号},",
				"          sales_ship_to_account_num = {出荷先},",
				"          sales_ship_to_short_name = {出荷先-略称},",
				"          sales_ship_to_name = {出荷先-名前},",
				"          sales_ship_to_name2 = {出荷先-名前2},",
				"          sales_ship_to_belonging = {出荷先-所属},",
				"          sales_ship_to_name_notes = {出荷先-名前備考},",
				"          sales_ship_to_prefectures = {出荷先-都道府県},",
				"          sales_ship_to_municipality = {出荷先-市町村},",
				"          sales_ship_to_address = {出荷先-住所},",
				"          sales_ship_to_building_name = {出荷先-建物名},",
				"          sales_ship_to_address_notes = {出荷先-住所備考},",
				"          sales_ship_to_remarks1 = {出荷先-備考1},",
				"          sales_ship_to_remarks2 = {出荷先-備考2},",
				"          sales_ship_to_remarks3 = {出荷先-備考3},",
				"          sales_ship_to_phone_num = {出荷先-電話番号},",
				"          sales_end_user_account_num = {カスタマー},",
				"          sales_end_user_short_name = {カスタマー-略称},",
				"          invoice_account = {請求先/元ID},",
				"          sales_invoice_short_name = {請求先-略称},",
				"          sales_invoice_name = {請求先-名前},",
				"          sales_invoice_name2 = {請求先-名前2},",
				"          sales_invoice_belonging = {請求先-所属},",
				"          sales_invoice_name_notes = {請求先-名前備考},",
				"          sales_invoice_post_code = {請求先-郵便番号},",
				"          sales_invoice_prefectures = {請求先-都道府県},",
				"          sales_invoice_municipality = {請求先-市町村},",
				"          sales_invoice_address = {請求先-住所},",
				"          sales_invoice_building_name = {請求先-建物名},",
				"          sales_invoice_address_notes = {請求先-住所備考},",
				"          sales_invoice_remarks1 = {請求先-備考1},",
				"          sales_invoice_remarks2 = {請求先-備考2},",
				"          sales_invoice_remarks3 = {請求先-備考3},",
				"          cust_collections = {回収先ID},",
				"          sales_cust_collection_short_name = {回収先-略称},",
				"          sales_person = {営業員},",
				"          sales_person_name = {営業員名},",
				"          carrier_cd = {運送業者},",
				"          carrier_name_alias = {運送業者-検索名},",
				"          oem_cd = {OEMコード},",
				"          oem_name = {OEM-名前},",
				"          oem_name2 = {OEM-名前2},",
				"          oem_prefectures = {OEM-都道府県},",
				"          oem_municipality = {OEM-市町村},",
				"          oem_address = {OEM-住所},",
				"          oem_building_name = {OEM-建物名},",
				"          oem_address_notes = {OEM-住所備考},",
				"          oem_remarks1 = {OEM-備考1},",
				"          oem_remarks2 = {OEM-備考2},",
				"          oem_remarks3 = {OEM-備考3},",
				"          sales_vend_account_num = {仕入先},",
				"          sales_vend_name_alias = {仕入先-検索名},",
				"          customer_requirements = {顧客の要求},",
				"          billing_block = {請求ブロック},",
				"          item_id = {品目番号},",
				"          item_name = {テキスト},",
				"          pack_style_name = {荷姿},",
				"          shipping_name_code = {出荷名コード},",
				"          shipping_name = {出荷名},",
				"          trade_mark_code = {商標コード},",
				"          trade_mark_name = {商標名},",
				"          sales_item_class_code = {商品大分類コード},",
				"          sales_item_class_name = {商品大分類名},",
				"          product_item_group_code = {製品群コード},",
				"          product_item_group_name = {製品群名},",
				"          sales_item_group_code = {商品群コード},",
				"          sales_item_group_name = {商品群名},",
				"          shipping_type = {配送タイプ},",
				"          truck_scale_type = {台貫区分},",
				"          product_type = {製品タイプ},",
				"          correction_category = {訂正区分},",
				"          invent_site_id = {サイト},",
				"          invent_site_name = {サイト名},",
				"          invent_location_id = {倉庫},",
				"          invent_location_name = {倉庫名},",
				"          receipt_date_requested = {入荷希望日},",
				"          shipping_date_requested = {出荷予定日},",
				"          shipping_date = {出荷日},",
				"          sales_status = {処理ステータス},",
				"          delivery_method = {荷渡方法},",
				"          delivery_method_description = {荷渡方法-説明},",
				"          detailed_status = {詳細ステータス},",
				"          customer_delete_flag = {カスタマー台帳削除},",
				"          customer_delete_reason = {カスタマー台帳削除理由},",
				"          purchase_order_number = {発注書番号},",
				"          purchase_order_status = {発注書-行ステータス},",
				"          picking_route = {ピッキング ルート},",
				"          inventory_order = {在庫注文},",
				"          picking_status = {処理ステータス2},",
				"          line_status = {販売注文-行ステータス},",
				"          truck_scale_completion_flag = {台貫完了区分},",
				"          invoice = {請求書},",
				"          invoice_line_num = {明細行番号2},",
				"          invoice_date = {請求日},",
				"          delivery_note_category = {納品書区分},",
				"          delivery_note_category_name = {納品書区分名},",
				"          closing_date = {締日},",
				"          created_date_time = {作成日時},",
				"          created_by = {作成者},",
				"          shipping_terms = {配送条件},",
				"          shipping_terms_description = {配送条件-説明},",
				"          payment_terms = {支払条件},",
				"          payment_terms_description = {支払条件-説明},",
				"          sales_consumer = {需要家},",
				"          updated_date_time = {変更日時},",
				"          updated_by = {更新者},",
				"          profit_and_loss_department = {損益負担部門},",
				"          qty_per_pack = {入数},",
				"          sales_qty = {数量},",
				"          sales_unit = {販売単位},",
				"          contract_unit_qty = {契約単価数量},",
				"          contract_unit_price_uom = {契約単価単位},",
				"          contract_unit_price = {契約単価},",
				"          net_amount = {正味金額},",
				"          shipping_qty = {出荷数量},",
				"          invoice_qty = {請求時数量},",
				"          invoice_unit_qty = {請求時契約単価数量},",
				"          invoice_contract_unit_price = {請求時契約単価},",
				"          invoice_net_amount = {請求時正味金額},",
				"          consumption_tax = {消費税額},",
				"          tax_rate = {税率},",
				"          factory_variable_costs = {変動製造費（工場）},",
				"          factory_fixed_costs = {固定製造費（工場）},",
				"          direct_delivery_variable_costs = {変動製造費（直納）},",
				"          one_price_variable_costs = {変動製造費（一物一価）},",
				"          one_price_fixed_costs = {固定製造費（一物一価）},",
				"          accounting_currency = {会計通貨},",
				"          countryregionid = {国／地域コード},",
				"          country = {国名},",
				"          billinig_date = {請求年月}",
				"     )) ~> csvDataInMiddleTable"
			]
		}
	}
}